<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Create short, shareable URLs with our fast and secure URL shortener using Base36 encoding and TinyURL API.">
  <meta name="keywords" content="URL shortener, Base36 encoding, TinyURL, short links">
  <meta name="author" content="URL Shortener">
  <title>Custom URL Shortener</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy47gV1vaPh6DDx1yHVL/1G3iW6kA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3B82F6',
            secondary: '#10B981',
            accent: '#8B5CF6',
            dark: '#1F2937',
            neutral: '#F3F4F6',
          },
          fontFamily: {
            sans: ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
          },
          boxShadow: {
            'glow': '0 0 15px rgba(59, 130, 246, 0.2)',
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-out',
            'slide-in': 'slideIn 0.3s ease-out',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0', transform: 'translateY(10px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            },
            slideIn: {
              '0%': { opacity: '0', transform: 'translateX(100px)' },
              '100%': { opacity: '1', transform: 'translateX(0)' },
            },
          },
        },
      },
    }

    // Base36 encoding/decoding
    const base36Chars = "0123456789abcdefghijklmnopqrstuvwxyz";

    function base36Encode(str) {
      let num = BigInt("0x" + Array.from(str).map(c => c.charCodeAt(0).toString(16)).join(""));
      let result = "";
      while (num > 0) {
        result = base36Chars[num % 36n] + result;
        num = num / 36n;
      }
      return result || "0";
    }

    function base36Decode(encoded) {
      try {
        let num = 0n;
        for (let c of encoded) {
          const index = base36Chars.indexOf(c.toLowerCase());
          if (index === -1) throw new Error("Invalid Base36 character");
          num = num * 36n + BigInt(index);
        }
        let hex = num.toString(16);
        if (hex.length % 2) hex = "0" + hex;
        let result = "";
        for (let i = 0; i < hex.length; i += 2) {
          result += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
        }
        return result;
      } catch (e) {
        console.error('Decode error:', e);
        return null;
      }
    }

    // Check for 'u' parameter and render redirect page immediately
    const params = new URLSearchParams(window.location.search);
    if (params.has("u")) {
      document.addEventListener('DOMContentLoaded', function() {
        const decodedId = base36Decode(params.get("u"));
        if (decodedId) {
          document.body.innerHTML = `
            <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-neutral to-blue-100 p-4">
              <section class="text-center bg-white p-8 rounded-2xl shadow-lg max-w-md w-full mx-auto animate-fade-in" role="region" aria-labelledby="redirect-heading">
                <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-6">
                  <i class="fas fa-external-link-alt text-primary text-3xl" aria-hidden="true"></i>
                </div>
                <h2 id="redirect-heading" class="text-2xl font-bold text-dark mb-3">Redirecting to Your Destination</h2>
                <p class="text-gray-600 mb-6">Please wait while we take you to your link...</p>
                <div class="mb-6">
                  <div class="h-2 bg-gray-100 rounded-full overflow-hidden mb-3">
                    <div id="progress-bar" class="h-full bg-primary transition-all duration-1000" style="width: 0%"></div>
                  </div>
                  <p class="text-sm text-gray-600">Redirecting in <span id="countdown" class="font-bold text-primary">10</span> seconds</p>
                </div>
                <button 
                  id="skipButton" 
                  class="px-6 py-2 bg-primary hover:bg-blue-600 focus:ring-4 focus:ring-blue-200 text-white rounded-lg font-medium transition-all duration-300 shadow-sm"
                  aria-label="Skip waiting and redirect immediately"
                >
                  Skip Waiting
                </button>
                <div class="mt-8 p-4 bg-neutral rounded-lg">
                  <p class="text-xs text-gray-500 mb-3 uppercase tracking-wider font-semibold">Advertisement</p>
                  <div class="ad-slot-1 bg-white p-4 rounded-lg border border-gray-100 flex items-center justify-center min-h-[100px]">
                    <p class="text-gray-500 text-sm">
                    <center>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5525538810839147"
     crossorigin="anonymous"></script>
<!-- hamrotools -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5525538810839147"
     data-ad-slot="9765483765"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</center>
</p>
                  </div>
                </div>
              </section>
            </div>
          `;
          const tinyUrl = "https://tinyurl.com/" + decodedId;
          startCountdown(10, tinyUrl);
        } else {
          document.body.innerHTML = `
            <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-neutral to-blue-100 p-4">
              <section class="bg-white p-8 rounded-2xl shadow-lg text-center max-w-md w-full mx-auto animate-fade-in" role="alert" aria-labelledby="error-heading">
                <i class="fas fa-exclamation-triangle text-yellow-500 text-5xl mb-6" aria-hidden="true"></i>
                <h2 id="error-heading" class="text-2xl font-bold text-dark mb-3">Invalid URL</h2>
                <p class="text-gray-600 mb-6">The shortened URL is invalid or may have expired.</p>
                <a 
                  href="${window.location.origin + window.location.pathname}" 
                  class="px-6 py-3 bg-primary hover:bg-blue-600 focus:ring-4 focus:ring-blue-200 text-white rounded-lg font-medium transition-all duration-300 shadow-sm"
                  aria-label="Return to URL shortener homepage"
                >
                  Back to Shortener
                </a>
              </section>
            </div>
          `;
          trackEvent('invalid_url_accessed');
        }
      });
    }
  </script>
  <script defer>
    // Analytics tracking
    function trackEvent(eventName, data = {}) {
      console.log('Analytics:', eventName, data);
    }

    // URL validation
    function isValidUrl(url) {
      try {
        new URL(url);
        return /^https?:\/\//i.test(url);
      } catch {
        return false;
      }
    }

    async function shortenUrl() {
      const inputUrl = document.getElementById("urlInput").value.trim();
      
      if (!inputUrl) {
        showAlert("Please enter a URL", "error");
        return;
      }

      if (!isValidUrl(inputUrl)) {
        showAlert("Please enter a valid URL starting with http:// or https://", "error");
        return;
      }

      try {
        const shortenBtn = document.getElementById("shortenBtn");
        shortenBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Shortening...';
        shortenBtn.disabled = true;
        shortenBtn.setAttribute('aria-busy', 'true');

        let tinyUrl;
        let attempts = 0;
        const maxAttempts = 3;

        while (attempts < maxAttempts) {
          try {
            const res = await fetch("https://tinyurl.com/api-create.php?url=" + encodeURIComponent(inputUrl), {
              signal: AbortSignal.timeout(5000)
            });
            tinyUrl = await res.text();
            if (tinyUrl.startsWith("http")) break;
            throw new Error("Invalid TinyURL response");
          } catch (e) {
            attempts++;
            if (attempts === maxAttempts) {
              throw new Error("Failed to shorten URL after multiple attempts");
            }
            await new Promise(resolve => setTimeout(resolve, 1000 * attempts));
          }
        }

        if (!tinyUrl.startsWith("http")) {
          throw new Error("Invalid TinyURL response");
        }

        const tinyId = tinyUrl.replace("https://tinyurl.com/", "");
        const encoded = base36Encode(tinyId);
        const finalUrl = window.location.origin + window.location.pathname + "?u=" + encoded;

        document.getElementById("result").innerHTML = `
          <section class="bg-white border border-gray-100 rounded-2xl p-6 mt-8 shadow-lg animate-fade-in" role="region" aria-labelledby="result-heading">
            <h3 id="result-heading" class="text-xl font-semibold text-dark mb-3 flex items-center">
              <i class="fas fa-link text-primary mr-2" aria-hidden="true"></i>Your Short URL
            </h3>
            <p class="text-gray-600 text-sm mb-4">Share this URL anywhere - it will redirect to your original content</p>
            <div class="mb-6">
              <div class="flex items-center shadow-sm">
                <input 
                  type="text" 
                  id="finalUrl" 
                  value="${finalUrl}" 
                  readonly 
                  class="flex-1 p-3 border border-gray-200 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white font-mono text-sm"
                  aria-label="Shortened URL"
                >
                <button 
                  onclick="copyToClipboard('finalUrl')" 
                  class="bg-primary hover:bg-blue-600 focus:ring-4 focus:ring-blue-200 text-white p-3 rounded-r-lg transition-all duration-300"
                  aria-label="Copy URL to clipboard"
                >
                  <i class="fas fa-copy" aria-hidden="true"></i>
                </button>
              </div>
            </div>
            <div class="flex flex-wrap gap-4">
              <a 
                href="${finalUrl}" 
                target="_blank" 
                class="px-4 py-2 bg-secondary hover:bg-green-600 focus:ring-4 focus:ring-green-200 text-white rounded-lg flex items-center transition-all duration-300"
                aria-label="Test shortened URL in new tab"
              >
                <i class="fas fa-external-link-alt mr-2" aria-hidden="true"></i> Test URL
              </a>
              <button 
                onclick="shareUrl('${finalUrl}')" 
                class="px-4 py-2 bg-accent hover:bg-purple-600 focus:ring-4 focus:ring-purple-200 text-white rounded-lg flex items-center transition-all duration-300"
                aria-label="Share shortened URL"
              >
                <i class="fas fa-share-alt mr-2" aria-hidden="true"></i> Share
              </button>
              <a 
                href="https://twitter.com/intent/tweet?text=Check%20this%20out&url=${encodeURIComponent(finalUrl)}" 
                target="_blank" 
                class="px-4 py-2 bg-blue-400 hover:bg-blue-500 focus:ring-4 focus:ring-blue-200 text-white rounded-lg flex items-center transition-all duration-300"
                aria-label="Share URL on Twitter"
              >
                <i class="fab fa-twitter mr-2" aria-hidden="true"></i> Tweet
              </a>
            </div>
          </section>
        `;

        trackEvent('url_shortened', { original_url_length: inputUrl.length, shortened_url: finalUrl });
      } catch (e) {
        showAlert(`Error: ${e.message}`, "error");
      } finally {
        const shortenBtn = document.getElementById("shortenBtn");
        shortenBtn.innerHTML = '<i class="fas fa-link mr-2" aria-hidden="true"></i> Shorten URL';
        shortenBtn.disabled = false;
        shortenBtn.removeAttribute('aria-busy');
      }
    }

    function copyToClipboard(elementId) {
      const copyText = document.getElementById(elementId);
      copyText.select();
      copyText.setSelectionRange(0, 99999);
      try {
        document.execCommand("copy");
        showAlert("URL copied to clipboard!", "success");
        trackEvent('url_copied', { element_id: elementId });
      } catch (e) {
        showAlert("Failed to copy URL", "error");
      }
    }

    function shareUrl(url) {
      if (navigator.share) {
        navigator.share({
          title: 'Shortened URL',
          text: 'Check out this shortened URL',
          url: url
        })
        .then(() => trackEvent('url_shared', { url }))
        .catch(error => {
          console.error('Share error:', error);
          copyToClipboard('finalUrl');
          showAlert("URL copied to clipboard. Share it anywhere!", "success");
        });
      } else {
        copyToClipboard('finalUrl');
        showAlert("URL copied to clipboard. Share it anywhere!", "success");
      }
    }

    function showAlert(message, type) {
      const existingAlert = document.querySelector('.custom-alert');
      if (existingAlert) existingAlert.remove();

      const alertDiv = document.createElement("div");
      alertDiv.className = `custom-alert fixed top-6 right-6 p-4 rounded-lg shadow-lg z-50 transform transition-all duration-300 ${
        type === "error" ? "bg-red-50 border-l-4 border-red-500 text-red-700" : "bg-green-50 border-l-4 border-green-500 text-green-700"
      }`;
      alertDiv.setAttribute('role', 'alert');
      alertDiv.setAttribute('aria-live', 'assertive');
      alertDiv.innerHTML = `
        <div class="flex items-center">
          <i class="fas ${type === "error" ? "fa-exclamation-circle" : "fa-check-circle"} mr-2" aria-hidden="true"></i>
          <p>${message}</p>
        </div>
      `;
      
      document.body.appendChild(alertDiv);
      
      setTimeout(() => {
        alertDiv.classList.add('opacity-0');
        setTimeout(() => alertDiv.remove(), 300);
      }, 3000);
    }

    function startCountdown(seconds, redirectUrl) {
      let counter = seconds;
      const countdownElement = document.getElementById('countdown');
      const progressBar = document.getElementById('progress-bar');
      
      countdownElement.textContent = counter;
      
      const countdownInterval = setInterval(() => {
        counter--;
        countdownElement.textContent = counter;
        
        const progressPercent = ((seconds - counter) / seconds) * 100;
        progressBar.style.width = `${progressPercent}%`;
        
        if (counter <= 0) {
          clearInterval(countdownInterval);
          trackEvent('url_redirected', { url: redirectUrl });
          window.location.href = redirectUrl;
        }
      }, 1000);
      
      document.getElementById('skipButton').addEventListener('click', function() {
        clearInterval(countdownInterval);
        trackEvent('url_redirect_skipped', { url: redirectUrl });
        window.location.href = redirectUrl;
      });
    }

    // Only run analytics on main page load if no 'u' parameter
    if (!params.has("u")) {
      window.addEventListener('load', () => trackEvent('page_load'));
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-neutral to-blue-100 min-h-screen">
  <!-- Only render main content if no 'u' parameter -->
  <div class="container mx-auto px-4 py-16">
    <header class="text-center mb-12">
      <div class="inline-flex items-center justify-center h-16 w-16 rounded-full bg-blue-50 text-primary mb-6 shadow-sm">
        <i class="fas fa-link text-3xl" aria-hidden="true"></i>
      </div>
      <h1 class="text-4xl md:text-5xl font-bold text-dark mb-4">URL Shortener</h1>
      <p class="text-gray-600 max-w-2xl mx-auto text-lg">Transform long URLs into short, shareable links using Base36 encoding for compact and reliable redirection.</p>
    </header>

    <main class="max-w-3xl mx-auto">
      <div class="ad-container mb-10 p-6 bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl border border-blue-100 shadow-sm animate-fade-in">
        <p class="text-xs text-blue-700 mb-3 uppercase tracking-wider font-semibold text-center">Sponsored</p>
        <div class="ad-slot-2 bg-white p-4 rounded-lg border border-blue-100 flex items-center justify-center min-h-[100px]">
          <p class="text-blue-600 text-sm"> 
          <center>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5525538810839147"
     crossorigin="anonymous"></script>
<!-- hamrotools -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5525538810839147"
     data-ad-slot="9765483765"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</center>
          </p>
        </div>
      </div>
      
      <div class="bg-white border border-gray-100 rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-glow animate-fade-in">
        <div class="p-1 bg-gradient-to-r from-primary to-accent"></div>
        <div class="px-8 py-10">
          <div class="mb-8">
            <label for="urlInput" class="block text-sm font-medium text-gray-700 mb-3">Paste your long URL</label>
            <div class="flex flex-col sm:flex-row gap-4">
              <input 
                type="url" 
                id="urlInput" 
                placeholder="https://example.com/very-long-url" 
                class="flex-1 px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white text-sm shadow-sm"
                required
                aria-required="true"
              >
              <button 
                id="shortenBtn"
                onclick="shortenUrl()" 
                class="bg-gradient-to-r from-primary to-accent hover:from-blue-600 hover:to-purple-600 focus:ring-4 focus:ring-blue-200 text-white px-6 py-3 rounded-lg font-medium transition-all duration-300 shadow-sm"
                aria-label="Shorten URL"
              >
                <i class="fas fa-link mr-2" aria-hidden="true"></i> Shorten URL
              </button>
            </div>
          </div>

          <div class="bg-blue-50 border border-blue-100 rounded-lg p-6">
            <div class="flex">
              <div class="flex-shrink-0">
                <i class="fas fa-info-circle text-primary text-lg mt-1" aria-hidden="true"></i>
              </div>
              <div class="ml-4">
                <h3 class="text-sm font-medium text-dark">How our URL shortener works</h3>
                <div class="mt-3 text-sm text-gray-600 space-y-2">
                  <p class="flex items-center"><span class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-bold mr-2">1</span> Your URL is shortened using TinyURL's service</p>
                  <p class="flex items-center"><span class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-bold mr-2">2</span> We apply Base36 encoding for additional compression</p>
                  <p class="flex items-center"><span class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-bold mr-2">3</span> You get a clean, short URL that redirects to your content</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="result" class="mt-8"></div>
      
      <div class="ad-container mt-10 p-6 bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl border border-green-100 shadow-sm animate-fold-in">
        <p class="text-xs text-green-700 mb-3 uppercase tracking-wider font-semibold text-center">Sponsored</p>
        <div class="ad-slot-3 bg-white p-4 rounded-lg border border-green-100 flex items-center justify-center min-h-[100px]">
          <p class="text-green-600 text-sm">
            <center>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5525538810839147"
     crossorigin="anonymous"></script>
<!-- hamrotools -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5525538810839147"
     data-ad-slot="9765483765"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</center></p>
        </div>
      </div>
    </main>

    <section class="mt-16 max-w-4xl mx-auto">
      <h2 class="text-3xl font-bold text-center text-dark mb-12">Why Choose Our URL Shortener</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white p-6 rounded-2xl shadow-lg text-center transition-all duration-300 hover:shadow-glow animate-fade-in">
          <div class="inline-flex items-center justify-center h-12 w-12 rounded-full bg-blue-50 text-primary mb-4">
            <i class="fas fa-compress-arrows-alt text-xl" aria-hidden="true"></i>
          </div>
          <h3 class="text-lg font-semibold text-dark mb-2">Compact URLs</h3>
          <p class="text-gray-600 text-sm">Base36 encoding creates the shortest possible URLs for easy sharing.</p>
        </div>
        
        <div class="bg-white p-6 rounded-2xl shadow-lg text-center transition-all duration-300 hover:shadow-glow animate-fade-in">
          <div class="inline-flex items-center justify-center h-12 w-12 rounded-full bg-green-iaxial text-secondary mb-4">
            <i class="fas fa-lock text-xl" aria-hidden="true"></i>
          </div>
          <h3 class="text-lg font-semibold text-dark mb-2">Secure</h3>
          <p class="text-gray-600 text-sm">No tracking or personal data stored, ensuring your privacy.</p>
        </div>
        
        <div class="bg-white p-6 rounded-2xl shadow-lg text-center transition-all duration-300 hover:shadow-glow animate-fold-in">
          <div class="inline-flex items-center justify-center h-12 w-12 rounded-full bg-purple-50 text-accent mb-4">
            <i class="fas fa-bolt text-xl" aria-hidden="true"></i>
          </div>
          <h3 class="text-lg font-semibold text-dark mb-2">Instant Redirect</h3>
          <p class="text-gray-600 text-sm">Fast redirection with minimal delays for seamless user experience.</p>
        </div>
      </div>
    </section>

    <footer class="mt-16 text-center text-gray-600 text-sm">
      <p>© 2025 URL Shortener. All rights reserved.</p>
      <p class="mt-2 text-xs">Powered by Base36 encoding and TinyURL API</p>
    </footer>
  </div>
</body>
</html>
