<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Daily Rojgari | Real-Time Job Vacancies in Nepal</title>
    <meta name="description" content="Nepal's fastest and most reliable job portal. Instant updates on government, NGO, banking, and private sector vacancies from official sources.">
    <meta name="keywords" content="Nepal jobs, rojgar, government vacancies, lok sewa, NGO jobs, banking jobs, daily job updates">
    <meta name="robots" content="index, follow">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #f8fafc;
            color: #1e293b;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Responsive grid: 1-col very small → 2-col mobile → 3-col desktop */
        .job-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            padding: 0 0.5rem;
        }
        @media (min-width: 480px) {
            .job-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.25rem;
            }
        }
        @media (min-width: 1024px) {
            .job-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 2rem;
                max-width: 1200px;
                margin: 0 auto;
                padding: 0;
            }
        }

        .job-card {
            background: #ffffff;
            border: 1px solid #f1f5f9;
            border-radius: 1.25rem;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .job-card:hover {
            border-color: #ef4444;
            transform: translateY(-8px);
            box-shadow: 0 20px 30px -8px rgba(0, 0, 0, 0.08);
        }

        .title-clamp {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-size: 0.875rem;
            line-height: 1.25;
            font-weight: 800;
            text-transform: uppercase;
            color: #0f172a;
        }
        @media (max-width: 640px) {
            .title-clamp {
                font-size: 0.8rem;
                line-height: 1.15;
            }
        }

        /* Fully responsive search bar */
        .search-wrapper {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 1rem;
        }
        .search-bar {
            position: relative;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            height: 64px;
        }
        .search-bar:focus-within {
            border-color: #ef4444;
            box-shadow: 0 0 0 5px rgba(239, 68, 68, 0.15);
        }
        .search-icon {
            position: absolute;
            left: 1.25rem;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
            pointer-events: none;
        }
        .search-input {
            width: 100%;
            height: 100%;
            padding: 0 4.5rem 0 3.5rem;
            font-size: 1.0625rem;
            font-weight: 500;
            outline: none;
            background: transparent;
        }
        .search-button {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            background: #0f172a;
            color: white;
            font-weight: 700;
            font-size: 0.9375rem;
            padding: 0.75rem 1.75rem;
            border-radius: 1rem;
            transition: background 0.3s ease;
        }
        .search-button:hover {
            background: #ef4444;
        }

        /* Mobile-specific adjustments */
        @media (max-width: 480px) {
            .search-bar {
                height: 56px;
                border-radius: 1.25rem;
            }
            .search-input {
                font-size: 1rem;
                padding: 0 4.25rem 0 3.25rem;
            }
            .search-icon {
                left: 1rem;
                width: 20px;
                height: 20px;
            }
            .search-button {
                padding: 0.65rem 1.5rem;
                font-size: 0.875rem;
            }
        }

        .pagination-btn {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            font-weight: 700;
            transition: all 0.2s ease;
        }
        .pagination-btn.active {
            background: #0f172a;
            color: #ffffff;
        }
        .pagination-btn:hover:not(.active) {
            background: #f1f5f9;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

<nav class="bg-white/90 backdrop-blur-md border-b border-slate-100 sticky top-0 z-50">
    <div class="container mx-auto px-4 h-16 flex items-center justify-start">
        <a href="https://www.singhyogendra.com.np/jobs-in-nepal" class="flex items-center gap-3">
            <div class="bg-red-600 p-2 rounded-lg">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
            </div>
            <span class="text-2xl font-extrabold tracking-tighter uppercase">
                Daily<span class="text-red-600">Rojgari</span>
            </span>
        </a>
    </div>
</nav>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8">
        
        <!-- Responsive Search Bar -->
        <div id="search-container" class="mb-12">
            <div class="search-wrapper">
                <div class="search-bar">
                    <div class="search-icon">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>
                    <input
                        type="text"
                        id="search-input"
                        placeholder="Search jobs..."
                        class="search-input text-slate-800"
                        onkeydown="if(event.key==='Enter') performSearch()"
                    >
                    <button onclick="performSearch()" class="search-button uppercase">
                        Search
                    </button>
                </div>
            </div>
        </div>

        <!-- Loader -->
        <div id="loader" class="hidden flex justify-center py-24">
            <div class="w-12 h-12 border-4 border-slate-200 border-t-red-600 rounded-full animate-spin"></div>
        </div>

        <!-- Job Grid -->
        <div id="job-grid" class="job-grid"></div>

        <!-- Pagination -->
        <div id="pagination" class="flex justify-center gap-4 mt-16">
            <button onclick="changePage(1)" id="pg1" class="pagination-btn active">1</button>
            <button onclick="changePage(2)" id="pg2" class="pagination-btn">2</button>
            <button onclick="changePage(3)" id="pg3" class="pagination-btn">3</button>
            <button onclick="changePage(4)" id="pg4" class="pagination-btn hidden">4</button>
            <button onclick="changePage(5)" id="pg5" class="pagination-btn hidden">5</button>
        </div>

        <!-- Job Detail View -->
        <div id="job-detail" class="hidden"></div>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-50 border-t border-slate-200 mt-20 py-12">
        <div class="container mx-auto px-4 max-w-5xl text-center">
            <h2 class="text-2xl font-extrabold text-slate-900 mb-4 uppercase tracking-tight">
                Never Miss an Opportunity
            </h2>
            <p class="text-slate-600 text-base leading-relaxed max-w-3xl mx-auto mb-10">
                Daily Rojgari aggregates verified job notices from government gazettes, leading newspapers, and official corporate websites across Nepal. 
                Designed for efficiency with a clean, fast-loading interface optimized for both mobile and desktop users.
            </p>
            <div class="flex justify-center gap-8 text-xs font-bold text-slate-500 uppercase tracking-widest mb-12">
                <span>Verified Sources</span>
                <span>•</span>
                <span>Daily Updates</span>
                <span>•</span>
                <span>Mobile-First Design</span>
            </div>
            <p class="text-slate-400 text-xs font-bold uppercase tracking-widest">
                © 2025 Daily Rojgari • All Rights Reserved
            </p>
        </div>
    </footer>

    <script>
        const API_URL = 'https://www.singhyogendra.com.np/data/all-jobs.json';

        function getTimeAgo(dateString) {
            const now = new Date();
            const postDate = new Date(dateString);
            const diffMs = now - postDate;
            const diffSec = Math.floor(diffMs / 1000);
            const diffMin = Math.floor(diffSec / 60);
            const diffHr = Math.floor(diffMin / 60);
            const diffDay = Math.floor(diffHr / 24);

            if (diffMin < 60) return `${diffMin} minute${diffMin !== 1 ? 's' : ''} ago`;
            if (diffHr < 24) return `${diffHr} hour${diffHr !== 1 ? 's' : ''} ago`;
            if (diffDay < 2) return 'Yesterday';
            if (diffDay < 30) return `${diffDay} day${diffDay !== 1 ? 's' : ''} ago`;
            return postDate.toLocaleDateString('en-NP', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        async function fetchJobs(page = 1) {
            const grid = document.getElementById('job-grid');
            const loader = document.getElementById('loader');
            grid.innerHTML = '';
            loader.classList.remove('hidden');

            try {
                const response = await fetch(`${API_URL}?per_page=99&page=${page}&orderby=date&order=desc`);
                if (!response.ok) throw new Error('Failed to fetch');
                const jobs = await response.json();
                loader.classList.add('hidden');
                renderJobs(jobs);
                updatePagination(page, response.headers.get('X-WP-TotalPages'));
            } catch (err) {
                loader.classList.add('hidden');
                grid.innerHTML = `<p class="text-center col-span-full py-20 text-slate-500">Unable to load jobs at this moment. Please try again later.</p>`;
            }
        }

        function renderJobs(jobs) {
            const grid = document.getElementById('job-grid');
            if (jobs.length === 0) {
                grid.innerHTML = `<p class="text-center col-span-full py-20 text-slate-500 text-lg">No jobs found matching your search.</p>`;
                return;
            }

            grid.innerHTML = jobs.map(job => {
                const hoursSincePost = (new Date() - new Date(job.date)) / 3600000;
                const isNew = hoursSincePost <= 24;

                return `
                <article class="job-card">
                    <div>
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-xs font-extrabold text-red-600 uppercase tracking-widest flex items-center gap-2">
                                ${isNew ? '<span class="relative flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span><span class="relative inline-flex rounded-full h-3 w-3 bg-red-600"></span></span>' : '<span class="w-3 h-3 bg-red-600 rounded-full"></span>'}
                                ${getTimeAgo(job.date)}
                            </span>
                        </div>
                        <h2 class="title-clamp mb-6">${job.title.rendered}</h2>
                    </div>
                    <a href="?job=${job.slug}" class="block text-center bg-slate-900 hover:bg-red-600 text-white py-4 rounded-xl text-xs font-bold uppercase tracking-wider transition shadow-md">
                        View Details
                    </a>
                </article>`;
            }).join('');
        }

        function updatePagination(current, totalPages) {
            document.querySelectorAll('.pagination-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('hidden');
            });
            const pagesToShow = Math.min(totalPages || 3, 5);
            for (let i = 1; i <= pagesToShow; i++) {
                const btn = document.getElementById('pg' + i);
                if (btn) {
                    btn.textContent = i;
                    btn.onclick = () => changePage(i);
                    btn.classList.remove('hidden');
                    if (i === current) btn.classList.add('active');
                }
            }
        }

        function changePage(page) {
            fetchJobs(page);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        async function performSearch() {
            const query = document.getElementById('search-input').value.trim();
            const grid = document.getElementById('job-grid');
            const loader = document.getElementById('loader');
            grid.innerHTML = '';
            loader.classList.remove('hidden');
            document.getElementById('pagination').classList.add('hidden');

            try {
                const url = query ? `${API_URL}?search=${encodeURIComponent(query)}&per_page=99` : `${API_URL}?per_page=99`;
                const res = await fetch(url);
                const jobs = await res.json();
                loader.classList.add('hidden');
                renderJobs(jobs);
            } catch (err) {
                loader.classList.add('hidden');
                grid.innerHTML = `<p class="text-center col-span-full py-20 text-slate-500">Search failed. Please try again.</p>`;
            }
        }

        async function loadDetail(slug) {
            document.getElementById('search-container').classList.add('hidden');
            document.getElementById('pagination').classList.add('hidden');
            document.getElementById('job-grid').classList.add('hidden');
            document.querySelector('footer').classList.add('hidden');

            const loader = document.getElementById('loader');
            loader.classList.remove('hidden');

            try {
                const res = await fetch(`${API_URL}?slug=${slug}`);
                const data = await res.json();
                loader.classList.add('hidden');

                if (data.length > 0) {
                    const job = data[0];
                    document.title = `${job.title.rendered} | Daily Rojgari`;

                    const detail = document.getElementById('job-detail');
                    detail.classList.remove('hidden');
                    detail.innerHTML = `
                    <section class="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden my-8">
                        <header class="p-8 md:p-16 bg-gradient-to-br from-slate-900 to-slate-800 text-white">
                            <a href="https://www.singhyogendra.com.np/jobs-in-nepal" class="inline-block mb-6 text-red-400 text-sm font-bold uppercase tracking-wider hover:underline">← Back to All Jobs</a>
                            <h1 class="text-3xl md:text-5xl font-extrabold uppercase leading-tight">${job.title.rendered}</h1>
                            <div class="mt-8 inline-block bg-white/20 px-5 py-3 rounded-full text-sm font-bold uppercase tracking-widest">
                                Published ${getTimeAgo(job.date)}
                            </div>
                        </header>
                        <div class="p-8 md:p-16 prose prose-lg max-w-none text-slate-700 job-content">
                            ${job.content.rendered}
                        </div>
                        <div class="p-8 bg-slate-50 text-center">
                            <button onclick="window.print()" class="inline-block bg-red-600 hover:bg-red-700 text-white px-12 py-5 rounded-2xl font-bold text-sm uppercase tracking-widest shadow-lg transition transform hover:scale-105">
                                Print / Save as PDF
                            </button>
                        </div>
                    </section>`;
                } else {
                    detail.innerHTML = `<p class="text-center py-20 text-slate-600">Job not found.</p>`;
                }
            } catch (err) {
                loader.classList.add('hidden');
                document.getElementById('job-detail').innerHTML = `<p class="text-center py-20 text-red-600">Failed to load job details.</p>`;
            }
        }

        // Initialize
        const params = new URLSearchParams(window.location.search);
        if (params.has('job')) {
            loadDetail(params.get('job'));
        } else {
            fetchJobs(1);
        }
    </script>
</body>
</html>
